<div class="header">
  <button class="btn-voltar" (click)="voltar()">
    <span class="seta-esquerda">&#8592;</span>
  </button>
  <h2 class="titulo">RELATÃ“RIOS</h2>
</div>

<div class="relatorio-container">
  <!-- Filtros -->
  <div class="filtros-container">
    <h3 class="filtros-titulo">ğŸ“… Filtros</h3>
    <div class="filtros-grid">
      <div class="filtro-item">
        <label for="periodo">PerÃ­odo</label>
        <select id="periodo" [(ngModel)]="periodoSelecionado" (change)="aplicarFiltros()">
          <option value="semana">Ãšltima Semana</option>
          <option value="mes">Ãšltimo MÃªs</option>
          <option value="trimestre">Ãšltimo Trimestre</option>
          <option value="ano">Ãšltimo Ano</option>
        </select>
      </div>
      <div class="filtro-item">
        <label for="disciplina">Disciplina</label>
        <select id="disciplina" [(ngModel)]="disciplinaSelecionada" (change)="aplicarFiltros()">
          <option *ngFor="let disc of disciplinas" [value]="disc.id">{{disc.nome}}</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Cards de Resumo -->
  <div class="resumo-grid">
    <div class="card-resumo">
      <div class="card-resumo-header">
        <span class="card-resumo-label">MÃ©dia Geral</span>
        <span class="icone-trend up">ğŸ“ˆ</span>
      </div>
      <p class="card-resumo-valor">{{mediaGeral}}</p>
      <p class="card-resumo-info positivo">+0.5 vs perÃ­odo anterior</p>
    </div>

    <div class="card-resumo">
      <div class="card-resumo-header">
        <span class="card-resumo-label">Atividades</span>
        <span class="icone-trend">ğŸ“</span>
      </div>
      <p class="card-resumo-valor">{{totalAtividades}}</p>
      <p class="card-resumo-info">Completadas</p>
    </div>

    <div class="card-resumo">
      <div class="card-resumo-header">
        <span class="card-resumo-label">PresenÃ§a</span>
        <span class="icone-trend">ğŸ“…</span>
      </div>
      <p class="card-resumo-valor">{{presenca}}%</p>
      <p class="card-resumo-info">{{diasPresentes}} de {{diasTotais}} dias</p>
    </div>

    <div class="card-resumo">
      <div class="card-resumo-header">
        <span class="card-resumo-label">Progresso</span>
        <span class="icone-trend">ğŸ“Š</span>
      </div>
      <p class="card-resumo-valor">{{progressoGeral}}%</p>
      <p class="card-resumo-info">Do conteÃºdo</p>
    </div>
  </div>

  <!-- Desempenho por Disciplina -->
  <div class="desempenho-container">
    <h3 class="desempenho-titulo">Desempenho por Disciplina</h3>
    <div class="disciplinas-list">
      <div class="card-disciplina" *ngFor="let disc of disciplinasFiltradas">
        <div class="disciplina-header">
          <div class="disciplina-info">
            <h4 class="disciplina-nome">{{disc.nome}}</h4>
            <span class="disciplina-status" [ngClass]="getClasseStatus(disc.status)">
              {{disc.status}}
            </span>
          </div>
          <span class="disciplina-nota">{{disc.nota}}</span>
        </div>

        <div class="progresso-section">
          <div class="progresso-info">
            <span>Progresso</span>
            <span>{{disc.progresso}}%</span>
          </div>
          <div class="barra-progresso">
            <div class="barra-progresso-fill" 
                 [ngClass]="getClasseStatus(disc.status)"
                 [style.width.%]="disc.progresso">
            </div>
          </div>
        </div>

        <p class="disciplina-atividades">
          {{disc.atividades}} atividades completadas no perÃ­odo
        </p>

        <!-- RelatÃ³rio texto (expansÃ­vel) -->
        <div class="relatorio-texto" *ngIf="disc.mostrarRelatorio">
          <p>{{disc.relatorio}}</p>
        </div>
        <button class="btn-ver-mais" (click)="toggleRelatorio(disc)">
          {{disc.mostrarRelatorio ? 'Ver menos â–²' : 'Ver anÃ¡lise detalhada â–¼'}}
        </button>
        <button class="btn-abrir-atividades" (click)="abrirAtividadesDisciplina(disc.id)">
          Abrir atividades
        </button>
      </div>
    </div>
  </div>

  <!-- RecomendaÃ§Ãµes -->
  <div class="recomendacoes-container">
    <h3 class="recomendacoes-titulo">ğŸ’¡ RecomendaÃ§Ãµes</h3>
    <ul class="recomendacoes-list">
      <li *ngFor="let rec of recomendacoes">â€¢ {{rec}}</li>
    </ul>
  </div>
</div>